{# finance/templates/finance/confirm_transfers.html #}
{% extends "base.html" %}
{% load humanize %}

{% block title %}ุชุฃููุฏ ุชุญูููุงุช ุงูุนููุงุก{% endblock %}

{% block content %}
<section class="page-section" dir="rtl">
  <div class="container">

    {# ===== ุงูููุฏุฑ ===== #}
    <div class="section-header mb-6">
      <div class="section-badge">๐ธ ุชุญูููุงุช ุงูุนููุงุก</div>
      <h1 class="section-title">ุชุฃููุฏ ุชุญูููุงุช ุงูุนููุงุก</h1>
      <p class="section-description">
        ููุงุชูุฑ ุบูุฑ ูุฏููุนุฉ ูุงู ุงูุนููู ุจุฅุฏุฎุงู ูุฑุฌุน ุงูุชุญููู ุงูุจููู ููุง.  
        ููููู ูุฑุงุฌุนุชูุง ููุณููุง ููุฏููุนุฉ ูุจุงุดุฑุฉ.
      </p>
    </div>

    {# ===== ุงูุฌุฏูู ===== #}
    <div class="profile-section rounded-2xl overflow-hidden shadow">
      <table class="w-full text-sm">
        <thead>
          <tr class="bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-300 border-b">
            <th class="py-3 px-4 text-right">ุฑูู ุงููุงุชูุฑุฉ</th>
            <th class="py-3 px-4 text-right">ุงูุงุชูุงููุฉ / ุงูุทูุจ</th>
            <th class="py-3 px-4 text-right">ุงููุจูุบ</th>
            <th class="py-3 px-4 text-right">ุงููุฑุฌุน ุงูุจููู</th>
            <th class="py-3 px-4 text-center">ุงูุฅุฌุฑุงุก</th>
          </tr>
        </thead>

        <tbody>
          {% if invoices %}
            {% for inv in invoices %}
            <tr class="border-b hover:bg-slate-50 dark:hover:bg-slate-700 transition">
              <td class="py-3 px-4 font-semibold text-slate-800 dark:text-slate-100">#{{ inv.id }}</td>

              <td class="py-3 px-4 text-slate-700 dark:text-slate-200">
                A{{ inv.agreement_id }}
                {% if inv.agreement and inv.agreement.request_id %}
                  / R{{ inv.agreement.request_id }}
                {% endif %}
              </td>

              <td class="py-3 px-4 font-bold text-primary-700 dark:text-primary-300">
                {{ inv.client_total_amount|floatformat:2 }} ุฑ.ุณ
              </td>

              <td class="py-3 px-4">
                <code class="px-2 py-1 bg-slate-100 dark:bg-slate-800 rounded text-slate-700 dark:text-slate-300">
                  {{ inv.paid_ref }}
                </code>
              </td>

              <td class="py-3 px-4 text-center flex flex-col md:flex-row gap-2 justify-center items-center">

                {# ุฒุฑ ูุณู ููุฏููุนุฉ #}
                <form method="post"
                      action="{% url 'finance:mark_invoice_paid' inv.id %}"
                      class="inline">
                  {% csrf_token %}
                  <input type="hidden" name="method" value="bank">
                  <input type="hidden" name="ref_code" value="{{ inv.ref_code }}">
                  <input type="hidden" name="paid_ref" value="{{ inv.paid_ref }}">
                  <button class="btn btn-primary btn-sm w-full md:w-auto">
                    โ ูุณู ููุฏููุนุฉ
                  </button>
                </form>

                {# ุฒุฑ ุงูุชูุงุตูู #}
                <a href="{% url 'finance:invoice_detail' inv.id %}"
                   class="btn btn-outline btn-sm w-full md:w-auto">
                  ๐๏ธ ุชูุงุตูู
                </a>

              </td>
            </tr>
            {% endfor %}
          {% else %}
            <tr>
              <td colspan="5"
                  class="py-6 text-center text-slate-500 dark:text-slate-300">
                ูุง ุชูุฌุฏ ุชุญูููุงุช ุจุงูุชุธุงุฑ ุงูุชุฃููุฏ.
              </td>
            </tr>
          {% endif %}
        </tbody>
      </table>
    </div>

  </div>
</section>
{% endblock %}
